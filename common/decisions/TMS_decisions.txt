TMS_third_trial_cat = {
	TMS_end_the_trial = {
		icon = GFX_decision_stable_door
		cost = 50
		ai_will_do = {
			base = 100
		}
		available = {
			NOT = {any_neighbor_country = {exists = yes}}
		}
		fire_only_once = yes
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision restore_throneroom"
			country_event = goldendawnrevolt.999
		}
	}

	TMS_construct_testsite = {
		icon = GFX_decision_stable_door
		cost = 50
		ai_will_do = {
			base = 100
		}
		visible = {
			has_completed_focus = TMS_dreams_of_future
		}
		available = {
			num_of_civilian_factories_available_for_projects > 3
		}
		modifier = {
			civilian_factory_use = 4
		}
		days_remove = 50
		fire_only_once = yes
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TMS_construct_testsite"
			set_province_name = {
				id = 6282
				name = TMS_megaspell_site_prov
			}
			set_country_flag = TMS_site_constructed_flag
		}
	}

	TMS_build_matrix_labs = {
		icon = GFX_decision_stable_door
		cost = 50
		ai_will_do = {
			base = 100
		}
		visible = {
			has_completed_focus = TMS_dreams_of_future
		}
		available = {
			num_of_civilian_factories_available_for_projects > 5
			has_country_flag = TMS_site_constructed_flag
		}
		modifier = {
			civilian_factory_use = 6
			research_speed_factor = -0.50
		}
		days_remove = 50
		fire_only_once = yes
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TMS_build_matrix_labs"
			add_tech_bonus = {
				name = magical_tech
				bonus = 2.5
				uses = 1
				category = magical_tech
			}
			set_country_flag = TMS_labs_constructed_flag
		}
	}

	TMS_supercritical_spellcore = {
		icon = GFX_decision_stable_door
		cost = 50
		ai_will_do = {
			base = 100
		}
		visible = {
			has_completed_focus = TMS_dreams_of_future
		}
		available = {
			num_of_civilian_factories_available_for_projects > 9
			has_country_flag = TMS_labs_constructed_flag
			has_resources_amount = {
				resource = crystals
				amount > 9
			}
		}
		modifier = {
			civilian_factory_use = 10
			country_resource_crystals = -10
		}
		days_remove = 50
		fire_only_once = yes
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TMS_build_matrix_labs"
			country_event = goldendawnrevolt.8
			set_country_flag = TMS_critical_core_flag
		}
	}

	TMS_heretic_tree = {
		icon = GFX_decision_stable_door
		cost = 20
		ai_will_do = {
			base = 100
		}
		visible = {
			has_completed_focus = TMS_dreams_of_future
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = TMS_need_dead_heretics_tt
			}
			check_variable = {
				golden_sacrifice > crystal_cost
			}
			has_country_flag = TMS_labs_constructed_flag
		}
		modifier = {
			stability_weekly = -0.01
		}
		days_remove = 20
		fire_only_once = no
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TMS_heretic_tree"
			capital_scope = {
				add_resource = {
					type = crystals
					amount = 4
				}
			}
			add_to_variable = {
				var = crystal_cost
				value = crystal_cost
			}
		}
	}

	TMS_construction_chamber_1 = {
		icon = GFX_decision_nuke
		cost = 20
		ai_will_do = {
			base = 100
		}
		visible = {
			has_completed_focus = TMS_replicate_second_trial
		}
		available = {
			num_of_civilian_factories_available_for_projects > 9
			has_resources_amount = {
				resource = crystals
				amount > 11
			}
			has_country_flag = TMS_critical_core_flag
		}
		modifier = {
			civilian_factory_use = 10
			country_resource_crystals = -12
		}
		days_remove = 40
		fire_only_once = no
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TMS_construction_chamber_1"
			add_nuclear_bombs = 1
			random_owned_state = {
				limit = {
					has_resources_amount = {
						resource = crystals
						amount > 1
					}
				}
				add_resource = {
					type = crystals
					amount = -2
				}
			}
		}
	}
	
	TMS_cleanse_state_dec = {
		icon = GFX_decision_category_viirats
		ai_will_do = {
			factor = 100
			
		}
		fire_only_once = no
		is_good = yes
		
		visible = {
			FROM = {
				NOT = {
					OR = {
					has_state_flag = TMS_golden_cleansing_flag
					is_core_of = TMS
					}
                }
				is_owned_by = TMS
				#any_neighbor_state = {has_state_flag = NCG_electric_territory_flag }
			}
		}
		available = {
			FROM = {
                political_power > 4
                NOT = {
                    has_state_flag = TMS_golden_cleansing_flag
                }
				is_owned_by = TMS
            }
		}
		target_root_trigger = {
			has_completed_focus = TMS_accelerate_the_timetable
        }
        state_target = yes
        on_map_mode = map_and_decisions_view  
		
		cost = 5
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TMS_cleanse_state_dec"
			custom_effect_tooltip = TMS_souls_for_golden_light_tt
                FROM = {
					add_state_flag = TMS_golden_cleansing_flag
					IF = {
						limit = { FROM = {AND = {state_population < 500 }}}
						add_manpower = -100
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 100
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population < 1000 state_population > 500}}}
						add_manpower = -500
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 500
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population < 2000 state_population > 1000}}}
						add_manpower = -1000
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 1000
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population < 3000 state_population > 2000}}}
						add_manpower = -1500
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 1500
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population < 4000 state_population > 3000}}}
						add_manpower = -2000
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 2000
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population < 5000 state_population > 4000}}}
						add_manpower = -2500
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 2500
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population < 6000 state_population > 5000}}}
						add_manpower = -3000
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 3000
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population < 10000 state_population > 6000}}}
						add_manpower = -5000
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 5000
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population < 15000 state_population > 10000}}}
						add_manpower = -8000
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 8000
							}
						}
					}
					ELSE_IF = {
						limit = { FROM = {AND = {state_population > 15000}}}
						add_manpower = -15000
						TMS = {
							add_to_variable = {
							var = golden_sacrifice
							value = 15000
							}
						}
					}
                }
			
		}
	}
	
	restore_throneroom = {
		icon = GFX_decision_stable_door
		cost = 50
		ai_will_do = {
			base = 0
		}
		available = {
			has_political_power > 49
			num_of_civilian_factories_available_for_projects > 1
		}
		fire_only_once = yes
		modifier = {
			civilian_factory_use = 2
		}
		days_remove = 80
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision restore_throneroom"
			add_stability = 0.10
		}
	}
	
}
