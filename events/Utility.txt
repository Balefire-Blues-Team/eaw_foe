add_namespace = utility
add_namespace = EAI_M

country_event = { ### SOL
	id = utility.9
	immediate = {log = "[GetDateText]: [Root.GetName]: event utility.9"}
	hidden = yes
	is_triggered_only = yes
	option = {
		restore_previous_manpower_function = yes
	}
}

country_event = { ### Healing Megaspell Effect
	id = utility.1
	immediate = {log = "[GetDateText]: [Root.GetName]: event utility.1"}
	hidden = yes
	is_triggered_only = yes
	option = {
		ROOT = {
			subtract_from_variable = {
			    var = healing_spell_amount
			    value = 1
			}
		}
	}
}

country_event = { ### Celestia One Cooldown Start
	id = utility.2
	immediate = {log = "[GetDateText]: [Root.GetName]: event utility.2"}
	hidden = yes
	is_triggered_only = yes
	option = {
		ROOT = {
			set_country_flag = celestia_one_cooldown_flag
			country_event = {
				id = utility.3
				days = 365
			}
		}
	}
}

country_event = { ### Celestia One Cooldown End
	id = utility.3
	immediate = {log = "[GetDateText]: [Root.GetName]: event utility.3"}
	hidden = yes
	is_triggered_only = yes
	option = {
		ROOT = {
			clr_country_flag = celestia_one_cooldown_flag
		}
	}
}

country_event = { ### Don't Play OWE
	id = utility.4
	title = utility.4.t
	desc = utility.4.desc
	immediate = {log = "[GetDateText]: [Root.GetName]: event utility.4"}
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = utility.4.a
		ai_chance = { base = 0}
		EYE = { change_tag_from = ROOT }
	}
}

country_event = { ### Shatter Pryncessin Zone
	id = utility.8
	title = utility.8.t
	desc = utility.8.desc
	immediate = {log = "[GetDateText]: [Root.GetName]: event utility.8"}
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = utility.8.a
		ai_chance = { base = 0}
		729 = { add_core_of = RST add_manpower = 4100}
		159 = { add_core_of = RST add_manpower = 7300}
		SEZ = { release = RST }
		733 = { add_core_of = LEE add_manpower = 4100}
		732 = { add_core_of = LEE add_manpower = 5800}
		SEZ = { release = LEE }
		151 = { add_core_of = NVR add_manpower = 6000}
		718 = { add_core_of = NVR add_manpower = 9000}
		163 = { add_core_of = NVR add_manpower = 5500}
		SEZ = { release = NVR }
		720 = { add_core_of = NAC add_manpower = 6800}
		168 = { add_core_of = NAC add_manpower = 5200}
		SEZ = { release = NAC }
		667 = { add_core_of = SDI add_manpower = 4900}
		676 = { add_core_of = SDI add_manpower = 8100}
		677 = { add_core_of = SDI add_manpower = 5300}
		SEZ = { release = SDI }
	}
}	


country_event = { ### EYE Explosion Game Rule
	id = utility.5
	title = utility.5.title
	desc = utility.5.desc
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event utility.5"
		hidden_effect = {
			CAT = {
				add_state_core = 593
				add_state_core = 513
				add_state_core = 505
				add_state_core = 492
				add_state_core = 533
				add_state_core = 510
				add_state_core = 669

				transfer_state = 593
				transfer_state = 513
				transfer_state = 505
				transfer_state = 492
				transfer_state = 533
				transfer_state = 510
				transfer_state = 669
				
				transfer_technology = yes
			}
			every_unit_leader = {
				limit = {
					has_id = 59304
				}
				set_nationality = CAT
			}

			FLT = {
				add_state_core = 529
				add_state_core = 504
				add_state_core = 502
				add_state_core = 50
				add_state_core = 512
				add_state_core = 523

				transfer_state = 529
				transfer_state = 504
				transfer_state = 502
				transfer_state = 50
				transfer_state = 512
				transfer_state = 523
				
				transfer_technology = yes
			}

			every_state = {
				limit = {
					OR = {
						is_core_of = CAT
						is_core_of = FLT
					}
				}
				teleport_armies = {
				    limit = {
				        tag = EYE
				    }
				    to_state = 532
				}
			}
		}
	}
	is_triggered_only = yes
	fire_only_once = yes

	option = { #Fillydelphia
		name = utility.5.a
		ai_chance = { base = 10 }
		remove_ideas = {
			slave_resistance
			fractured_comm
			army_chaos
		}
		white_peace = SSC
		custom_effect_tooltip = load_generic_focus_tree_tt
		hidden_effect = {
			load_focus_tree = gensettlers
			set_country_flag = change_to_settler_tree_flag
			mark_focus_tree_layout_dirty = yes
		}
	}
	option = { #Cathedral
		name = utility.5.b
		ai_chance = { base = 0 }
		CAT = { change_tag_from = ROOT }
		hidden_effect = {
			EYE = {
				load_focus_tree = gensettlers
				set_country_flag = change_to_settler_tree_flag
				mark_focus_tree_layout_dirty = yes
				remove_ideas = {
					slave_resistance
					fractured_comm
					army_chaos
				}
				white_peace = SSC
			}
		}
	}
	option = { #Flatlanders
		name = utility.5.c
		ai_chance = { base = 0 }
		FLT = { change_tag_from = ROOT }
		hidden_effect = {
			EYE = {
				load_focus_tree = gensettlers
				set_country_flag = change_to_settler_tree_flag
				mark_focus_tree_layout_dirty = yes
				remove_ideas = {
					slave_resistance
					fractured_comm
					army_chaos
				}
				white_peace = SSC
			}
		}
	}
}

country_event = { ### SSC Explosion Game Rule
	id = utility.6
	title = utility.6.title
	desc = utility.6.desc
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event utility.6"
		hidden_effect = {
			SSC = {
				remove_state_core = 554
				remove_state_core = 487
				remove_state_core = 85
				remove_state_core = 5
				remove_state_core = 546

				delete_unit_template_and_units = {
					division_template = "Raider Warband"
				}
			}
			SSS = {
				transfer_state = 85
				transfer_state = 5
				transfer_state = 546
				
				transfer_technology = yes
			}

			SSR = {
				transfer_state = 554
				transfer_state = 487
				
				transfer_technology = yes
			}

			FSR = {
				transfer_state = 543
			}

			every_state = {
				limit = {
					OR = {
						is_core_of = SSS
						is_core_of = SSR
					}
				}
				teleport_armies = {
				    limit = {
				        tag = SSC
				    }
				    to_state = 558
				}
			}
		}
	}
	is_triggered_only = yes
	fire_only_once = yes

	option = { #Sunny Shoals
		name = utility.6.a
		ai_chance = { base = 10 }
		remove_ideas = {
			SSC_fractured_coalition
		}
		set_cosmetic_tag = SSC_shoals
	}
	option = { #Hoofsburg
		name = utility.6.b
		ai_chance = { base = 0 }
		SSS = { change_tag_from = ROOT }
		hidden_effect = {
			SSC = {
				remove_ideas = {
					SSC_fractured_coalition
				}
				set_cosmetic_tag = SSC_shoals
			}
		}
	}
	option = { #Raiders
		name = utility.6.c
		ai_chance = { base = 0 }
		SSR = { change_tag_from = ROOT }
		hidden_effect = {
			SSC = {
				remove_ideas = {
					SSC_fractured_coalition
				}
				set_cosmetic_tag = SSC_shoals
			}
		}
	}
}


country_event = { ### COM Anarchy
	id = utility.7
	title = utility.7.t
	desc = utility.7.desc
	immediate = {log = "[GetDateText]: [Root.GetName]: event utility.7"}
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = utility.7.a
		ai_chance = { base = 0}
		IF = {
			limit = {
				owns_state = 204
			}
			NOV = {transfer_state = 204}
			NOV = {set_cosmetic_tag = NOV_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 276
				owns_state = 264
				owns_state = 251
			}
			CEX = {transfer_state = 276 add_state_core = 276}
			CEX = {transfer_state = 264 add_state_core = 264}
			CEX = {transfer_state = 251 add_state_core = 251}
		}
		IF = {
			limit = {
				owns_state = 71
			}
			EPC = {transfer_state = 71 add_state_core = 71}
		}
		IF = {
			limit = {
				owns_state = 201
			}
			NSE = {transfer_state = 201 add_state_core = 201}
		}
		IF = {
			limit = {
				owns_state = 321
				owns_state = 179
			}
			DSB = {transfer_state = 321 add_state_core = 321}
			DSB = {transfer_state = 179 add_state_core = 179}
			DSB = {set_cosmetic_tag = DSB_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 68
				owns_state = 359
			}
			DBB = {transfer_state = 68 add_state_core = 68}
			DBB = {transfer_state = 359 add_state_core = 359}
		}
		IF = {
			limit = {
				owns_state = 152
			}
			AGS = {transfer_state = 152 add_state_core = 152}
		}
		IF = {
			limit = {
				owns_state = 197
			}
			BMR = {transfer_state = 197 add_state_core = 197}
		}
		IF = {
			limit = {
				owns_state = 268
				owns_state = 30
			}
			PHE = {transfer_state = 268 add_state_core = 268}
			PHE = {transfer_state = 30 add_state_core = 30}
			PHE = {set_cosmetic_tag = PHE_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 238
				owns_state = 377
			}
			UAC = {transfer_state = 238 add_state_core = 238}
			UAC = {transfer_state = 377 add_state_core = 377}
		}
		IF = {
			limit = {
				owns_state = 401
				owns_state = 117
			}
			SLC = {transfer_state = 401 add_state_core = 401}
			SLC = {transfer_state = 117 add_state_core = 117}
			SLC = {set_cosmetic_tag = SLC_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 361
			}
			DEC = {transfer_state = 361 add_state_core = 361}
			DEC = {set_cosmetic_tag = DEC_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 209
				owns_state = 344
			}
			KHA = {transfer_state = 209 add_state_core = 209}
			KHA = {transfer_state = 344 add_state_core = 344}
			KHA = {set_cosmetic_tag = KHA_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 395
			}
			TAR = {transfer_state = 395 add_state_core = 395}
			TAR = {set_cosmetic_tag = TAR_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 210
				owns_state = 118
				owns_state = 73
				owns_state = 386
			}
			TFS = {transfer_state = 210 add_state_core = 210}
			TFS = {transfer_state = 118 add_state_core = 118}
			TFS = {transfer_state = 73 add_state_core = 73}
			TFS = {transfer_state = 386 add_state_core = 386}
		}
		IF = {
			limit = {
				owns_state = 357
				owns_state = 387
			}
			AOS = {transfer_state = 357 add_state_core = 357}
			AOS = {transfer_state = 387 add_state_core = 387}
			AOS = {set_cosmetic_tag = AOS_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 105
				owns_state = 363
			}
			TUV = {transfer_state = 105 add_state_core = 105}
			TUV = {transfer_state = 363 add_state_core = 363}
		}
		IF = {
			limit = {
				owns_state = 323
				owns_state = 351
			}
			BFR = {transfer_state = 323 add_state_core = 323}
			BFR = {transfer_state = 351 add_state_core = 351}
		}
		IF = {
			limit = {
				owns_state = 80
				owns_state = 79
			}
			CDI = {transfer_state = 80 add_state_core = 80}
			CDI = {transfer_state = 79 add_state_core = 79}
		}
		IF = {
			limit = {
				owns_state = 331
			}
			SOL = {transfer_state = 331 add_state_core = 331}
			SOL = {set_cosmetic_tag = SOL_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 835
			}
			PEN = {transfer_state = 835 add_state_core = 835}
			PEN = {set_cosmetic_tag = PEN_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 82
				owns_state = 308
			}
			CRF = {transfer_state = 82 add_state_core = 82}
			CRF = {transfer_state = 308 add_state_core = 308}
		}
		IF = {
			limit = {
				owns_state = 70
				owns_state = 98
			}
			MFT = {transfer_state = 70 add_state_core = 70}
			MFT = {transfer_state = 98 add_state_core = 98}
		}
		IF = {
			limit = {
				owns_state = 140
			}
			COM = {transfer_state = 140 add_state_core = 140}
			COM = {set_cosmetic_tag = COM_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 121
				owns_state = 215
			}
			SEN = {transfer_state = 121 add_state_core = 121}
			SEN = {transfer_state = 215 add_state_core = 215}
		}
		IF = {
			limit = {
				owns_state = 267
			}
			GCY = {transfer_state = 267 add_state_core = 267}
		}
		IF = {
			limit = {
				owns_state = 240
			}
			CBU = {transfer_state = 240 add_state_core = 240}
		}
		IF = {
			limit = {
				owns_state = 422
				owns_state = 249
				owns_state = 262
			}
			COC = {transfer_state = 422 add_state_core = 422}
			COC = {transfer_state = 249 add_state_core = 249}
			COC = {transfer_state = 262 add_state_core = 262}
			COC = {set_cosmetic_tag = COC_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 245
				owns_state = 307
				owns_state = 273
			}
			COR = {transfer_state = 245 add_state_core = 245}
			COR = {transfer_state = 307 add_state_core = 307}
			COR = {transfer_state = 273 add_state_core = 273}
			COR = {set_cosmetic_tag = COR_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 282
			}
			LAE = {transfer_state = 282 add_state_core = 282}
		}
		IF = {
			limit = {
				owns_state = 305
				owns_state = 170
			}
			SMT = {transfer_state = 305 add_state_core = 305}
			SMT = {transfer_state = 170 add_state_core = 170}
		}
		IF = {
			limit = {
				owns_state = 318
				owns_state = 271
			}
			COL = {transfer_state = 318 add_state_core = 318}
			COL = {transfer_state = 271 add_state_core = 271}
			COL = {set_cosmetic_tag = COL_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 291
			}
			EXU = {transfer_state = 291 add_state_core = 291}
		}
		IF = {
			limit = {
				owns_state = 292
				owns_state = 174
			}
			ARR = {transfer_state = 292 add_state_core = 292}
			ARR = {transfer_state = 174 add_state_core = 174}
			ARR = {set_cosmetic_tag = ARR_anarchy_36}
		}
		IF = {
			limit = {
				owns_state = 332
			}
			NKD = {transfer_state = 332 add_state_core = 332}
		}
		IF = {
			limit = {
				owns_state = 315
				owns_state = 314
				owns_state = 352
			}
			DPC = {transfer_state = 315 add_state_core = 315}
			DPC = {transfer_state = 314 add_state_core = 314}
			DPC = {transfer_state = 352 add_state_core = 352}
		}
		
		
		release = PAR
		release = SKY
		release = ALB
	}
}	

country_event = { ### SHA Explosion Game Rule
	id = utility.7
	title = utility.7.title
	desc = utility.7.desc
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event utility.7"
		hidden_effect = {
			SHA = {
				remove_state_core = 562
				remove_state_core = 228
				remove_state_core = 25

				remove_state_core = 572
				remove_state_core = 500
				remove_state_core = 588

				remove_state_core = 334
				remove_state_core = 287
				remove_state_core = 261
				remove_state_core = 254

				remove_state_core = 260
				remove_state_core = 311
				remove_state_core = 578
				remove_state_core = 810
			}

			COT = {
				transfer_state = 260
				transfer_state = 311
				transfer_state = 578
				transfer_state = 810
				
				transfer_technology = yes
			}

			SHC = {
				transfer_state = 334
				transfer_state = 287
				transfer_state = 261
				transfer_state = 254
				
				transfer_technology = yes
			}

			TPU = {
				transfer_state = 562
				transfer_state = 288
				transfer_state = 25
				
				transfer_technology = yes
			}

			GTC = {
				transfer_state = 572
				transfer_state = 500
				transfer_state = 588
				
				transfer_technology = yes
			}

			every_state = {
				limit = {
					OR = {
						is_core_of = COT
						is_core_of = SHC
						is_core_of = TPU
						is_core_of = GTC
					}
				}
				teleport_armies = {
				    limit = {
				        tag = SHA
				    }
				    to_state = 610
				}
			}

			transfer_navy = {
				target = GTC
			}
		}
	}
	is_triggered_only = yes
	fire_only_once = yes

	option = { #Play as SHA
		name = utility.7.a
		ai_chance = { base = 10 }
		hidden_effect = {
			load_focus_tree = gensettlers
			set_country_flag = change_to_settler_tree_flag
			mark_focus_tree_layout_dirty = yes
		}
	}
	option = { #Play as a breakaway
		name = utility.7.b
		ai_chance = { base = 10 }
		hidden_effect = {
			load_focus_tree = gensettlers
			set_country_flag = change_to_settler_tree_flag
			mark_focus_tree_layout_dirty = yes
		}
		country_event = utility.8
	}
}

country_event = { ### SSC Explosion Game Rule
	id = utility.8
	title = utility.8.title
	desc = utility.8.desc
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event utility.8"
	}
	is_triggered_only = yes
	fire_only_once = yes

	option = { #Corona
		name = utility.8.a
		ai_chance = { base = 10 }
		COT = { change_tag_from = ROOT }
	}
	option = { #Sherhoof
		name = utility.8.b
		ai_chance = { base = 0 }
		SHC = { change_tag_from = ROOT }
	}
	option = { #The Pure
		name = utility.8.c
		ai_chance = { base = 0 }
		TPU = { change_tag_from = ROOT }
	}
	option = { #Greenway
		name = utility.8.d
		ai_chance = { base = 0 }
		GTC = { change_tag_from = ROOT }
	}
}

#Phoenix Supremacy Gamerule
country_event = {
	id = utility.9
	title = utility.9.t
	desc = utility.9.desc
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event utility.9"
		IF = {
			limit = {
				has_game_rule = {
					rule = PHE_great_phoenix_rule 
					option = YES_PHEONIX
				}
			}
			PHE = {	set_country_flag = PHE_pheonix_rises_flag }
		}
		IF = {
			limit = {
				has_game_rule = {
					rule = PHE_great_phoenix_rule 
					option = RANDOM_PHEONIX
				}
			}
			random_list = {
				95 = {
					PHE = { add_manpower = 1 }
				}
				5 = {
					PHE = {	set_country_flag = PHE_pheonix_rises_flag }
				}
			}
		}
	}
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = utility.9.a
		ai_chance = { base = 95 }
		
	}
}

country_event = {
	id = EAI_M.8
	hidden = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_popularities = {
			visionary = save_visionary
			survivalism = save_survivalism
			destruction = save_destruction
			continuation = save_continuation
		}	
		if = {
			limit = { has_country_flag = was_visionary }
			set_politics = {
				ruling_party = visionary
			}
		}
		if = {
			limit = { has_country_flag = was_survivalism }
			set_politics = {
				ruling_party = survivalism
			}
		}
		if = {
			limit = { has_country_flag = was_destruction }
			set_politics = {
				ruling_party = destruction
			}
		}
		if = {
			limit = { has_country_flag = was_continuation }
			set_politics = {
				ruling_party = continuation
			}
		}
		
		clear_variable = was_visionary
		clear_variable = was_survivalism
		clear_variable = was_destruction
		clear_variable = was_continuation
	}
	
	option = { }
	
}
