add_namespace = bloodyarmy
add_namespace = bloody_border_war

country_event = { ### Attack New Mareway
 	id = bloodyarmy.1
 	title = bloodyarmy.1.title
 	desc = bloodyarmy.1.desc
	picture = GFX_event_test

	is_triggered_only = yes
 	fire_only_once = yes

	option = { #Attack
		name = bloodyarmy.1.a
		ai_chance = {
			base = 20
			modifier = {
				add = 30
				has_army_manpower = { size > 1499 }
			}
		}
		
		declare_war_on = {
   			target = MWY
   			type = annex_everything
		}
		RED = {
			hidden_effect = {
				set_country_flag =  RED_bloody_attack
			}
		}

		hidden_effect = {
			set_country_flag =  bloody_attack
		}
	}
	option = { #Decline
		name = bloodyarmy.1.b
		ai_chance = { 
			base = 5
			modifier = {
				add = 145
				NOT = { has_government = destruction }
			}
		}

		diplomatic_relation = {
		    country = RED
		    relation = non_aggression_pact
		    active = no
		}

		RED = {
			country_event = {
    			id = redeye.10
    			days = 1
    			random = 2
			}
			hidden_effect = {
				set_country_flag = bloody_attack_betrayal
			}
		}

		hidden_effect = {
			set_country_flag = ERA_bloody_attack_betrayal
		}
	}
}

country_event = { ### New Mareway Beaten
 	id = bloodyarmy.2
 	title = bloodyarmy.2.title
 	desc = bloodyarmy.2.desc
	picture = GFX_event_test

	trigger = {
		has_country_flag = bloody_attack
		controls_state = 549
		MWY = {
			exists = no
		}
		NOT = {
			has_global_flag = redeye_is_dead
		}
	}
 	fire_only_once = yes

	option = { #Uphold the deal
		name = bloodyarmy.2.a
		ai_chance = {
			base = 30
		}
		
		RED = {
			country_event = {
    			id = redeye.42
    			days = 1
    			random = 2
			}
		}
	}
	option = { #Fuck you Red Eye
		name = bloodyarmy.2.b
		ai_chance = { 
			base = 10
			modifier = {
				add = 30
				has_army_manpower = { size > 3999 }
			}
		}

		RED = {
			country_event = {
    			id = redeye.43
    			days = 1
    			random = 2
			}
		}
	}
}

country_event = { ###Past Glories
 	id = bloodyarmy.3
 	title = bloodyarmy.3.title
 	desc = bloodyarmy.3.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { #Flatlanders
		name = bloodyarmy.3.a
	 
 	}
	option = { #Jasmine
		name = bloodyarmy.3.b
		
	}
	option = { #Neocastle
		name = bloodyarmy.3.c
		
	}
}

country_event = { ###Wounded, but not Defeated
 	id = bloodyarmy.4
 	title = bloodyarmy.4.title
 	desc = bloodyarmy.4.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { #Winning over the Serfs
		name = bloodyarmy.4.a
	 
 	}
	option = { #Solidifying the Army
		name = bloodyarmy.4.b

	}
	option = { #Settling down
		name = bloodyarmy.4.c

	}
}

country_event = { ###A Visit From Auntie
 	id = bloodyarmy.5
 	title = bloodyarmy.5.title
 	desc = bloodyarmy.5.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { #Stay sane
		name = bloodyarmy.5.a
	 
 	}
	option = { #Lose sanity
		name = bloodyarmy.5.b

		custom_effect_tooltip = ERA_lose_one_sanity_tt
		hidden_effect = {
			ERA_decrease_sanity_effect = yes
		}
	}
	option = { #Lose double sanity
		name = bloodyarmy.5.c

		custom_effect_tooltip = ERA_lose_two_sanity_tt
		hidden_effect = {
			ERA_decrease_sanity_effect = yes
			ERA_decrease_sanity_effect = yes
		}
	}
}

country_event = { ###Shatterhorn News
 	id = bloodyarmy.6
 	title = bloodyarmy.6.title
 	desc = bloodyarmy.6.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { #Prepare my retinue!
		name = bloodyarmy.6.a
		
 	}
}

country_event = { ###Great Revolt News
 	id = bloodyarmy.7
 	title = bloodyarmy.7.title
 	desc = bloodyarmy.7.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { #Curious...
		name = bloodyarmy.7.a
		
 	}
}

country_event = { ### ERA - Win Shatterhorn BW
 	id = bloody_border_war.1
 	title = bloody_border_war.1.title
 	desc = bloody_border_war.1.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	 immediate = {
		hidden_effect = {
			if = {
				limit = { has_event_target = raided_state }
				set_variable = { temp_loot = raided_state.industrial_complex_level }
				add_to_variable = { temp_loot = raided_state.arms_factory_level }
			}
			else = {
				set_variable = { temp_loot = FROM.FROM.FROM.industrial_complex_level }
				add_to_variable = { temp_loot = FROM.FROM.FROM.arms_factory_level }
			}
			clamp_variable = {
				var = temp_loot
				min = 2
				max = 6
			}
			add_to_variable = { loot = temp_loot }
		}
	}

	option = { 
		name = bloody_border_war.1.a
		custom_effect_tooltip = loot_tp
		hidden_effect = {
			clear_variable = temp_loot
		}
		set_country_flag = ERA_won_shatterhorn_raid_flag
 	}
}

country_event = { ### ERA - Lose Shatterhorn BW
 	id = bloody_border_war.2
 	title = bloody_border_war.2.title
 	desc = bloody_border_war.2.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { 
		name = bloody_border_war.2.a
		add_manpower = -200
		set_country_flag = ERA_lost_shatterhorn_raid_flag
 	}
}

country_event = { ### ERA - Cancel Shatterhorn BW
 	id = bloody_border_war.3
 	title = bloody_border_war.3.title
 	desc = bloody_border_war.3.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { 
		name = bloody_border_war.3.a
		set_country_flag = ERA_lost_shatterhorn_raid_flag
 	}
}

country_event = { ### MWY - Win Shatterhorn BW
 	id = bloody_border_war.4
 	title = bloody_border_war.4.title
 	desc = bloody_border_war.4.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { 
		name = bloody_border_war.4.a
		
 	}
}

country_event = { ### MWY - Lose Shatterhorn BW
 	id = bloody_border_war.5
 	title = bloody_border_war.5.title
 	desc = bloody_border_war.5.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { 
		name = bloody_border_war.5.a
		
 	}
}

country_event = { ### MWY - Cancel Shatterhorn BW
 	id = bloody_border_war.6
 	title = bloody_border_war.6.title
 	desc = bloody_border_war.6.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { 
		name = bloody_border_war.6.a
		
 	}
}

country_event = { ### ERA - Win 2nd Shatterhorn BW
 	id = bloody_border_war.7
 	title = bloody_border_war.7.title
 	desc = bloody_border_war.7.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	 immediate = {
		hidden_effect = {
			if = {
				limit = { has_event_target = raided_state }
				set_variable = { temp_loot = raided_state.industrial_complex_level }
				add_to_variable = { temp_loot = raided_state.arms_factory_level }
			}
			else = {
				set_variable = { temp_loot = FROM.FROM.FROM.industrial_complex_level }
				add_to_variable = { temp_loot = FROM.FROM.FROM.arms_factory_level }
			}
			clamp_variable = {
				var = temp_loot
				min = 4
				max = 6
			}
			add_to_variable = { loot = temp_loot }
		}
	}

	option = { 
		name = bloody_border_war.7.a
		custom_effect_tooltip = loot_tp
		hidden_effect = {
			clear_variable = temp_loot
		}
		add_political_power = 50
		add_war_support = 0.05

		add_equipment_to_stockpile = {
			type = ballistic_equipment_1
			amount = 150
			producer = MWY
		}

		add_equipment_to_stockpile = {
			type = demolitions_equipment_1
			amount = 25
			producer = MWY
		}
 	}
}

country_event = { ### ERA - Lose Shatterhorn BW
 	id = bloody_border_war.8
 	title = bloody_border_war.8.title
 	desc = bloody_border_war.8.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { 
		name = bloody_border_war.8.a
		add_manpower = -300
		add_political_power = -50
		add_war_support = -0.10
 	}
}

country_event = { ### ERA - Cancel Shatterhorn BW
 	id = bloody_border_war.9
 	title = bloody_border_war.9.title
 	desc = bloody_border_war.9.desc
	picture = GFX_event_medieval_city_3

	is_triggered_only = yes
 	fire_only_once = yes

	option = { 
		name = bloody_border_war.9.a
		add_manpower = -150
		add_political_power = -25
		add_war_support = -0.05
 	}
}

